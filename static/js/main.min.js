// Minified Genie Modernized main.js (see main.js for full logic)
document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("loading-overlay");function e(){t&&t.classList.add("show")}function n(){t&&t.classList.remove("show")}n(),document.querySelectorAll("a").forEach(t=>{t.addEventListener("click",function(n){if("_blank"===this.target||this.href.startsWith("javascript:")||this.classList.contains("no-loader"))return;if(this.hash&&this.pathname===window.location.pathname)return;const r=this.getAttribute("data-bs-toggle");if("dropdown"===r||"collapse"===r||"modal"===r)return;const o=(this.getAttribute("href")||"").toLowerCase();if(o.includes("export")||o.includes("download")||o.endsWith(".docx")||o.endsWith(".csv")||o.endsWith(".xlsx"))return;e(),setTimeout(n,8e3)}.bind(t,n))}),document.querySelectorAll("form").forEach(t=>{t.addEventListener("submit",function(){if("_blank"===this.target||this.classList.contains("no-loader"))return;e(),setTimeout(n,8e3);})}),window.addEventListener("load",n),window.addEventListener("pageshow",function(t){t.persisted&&n()}),function(){const t=document.getElementById("darkModeToggle"),e=document.body,n=t?t.querySelector("i"):null;function r(t){if("dark"===t){e.classList.add("dark-mode"),n&&(n.classList.remove("fa-moon"),n.classList.add("fa-sun")),localStorage.setItem("theme","dark")}else{e.classList.remove("dark-mode"),n&&(n.classList.remove("fa-sun"),n.classList.add("fa-moon")),localStorage.setItem("theme","light")}try{const e=document.querySelector('meta[media="(prefers-color-scheme: light)"][name="theme-color"]'),n=document.querySelector('meta[media="(prefers-color-scheme: dark)"][name="theme-color"]');e&&n&&("dark"===t?n.setAttribute("content",getComputedStyle(document.documentElement).getPropertyValue("--bg-main").trim()||"#1a1a1a"):e.setAttribute("content",getComputedStyle(document.documentElement).getPropertyValue("--bg-main").trim()||"#f8f9fa"))}catch(t){}}if(t&&n){let o=localStorage.getItem("theme");o||(o=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),r(o);try{t.setAttribute("aria-pressed",("dark"===o).toString()),t.setAttribute("title","dark"===o?"Comută la tema luminoasă":"Comută la tema întunecată")}catch(t){}t.addEventListener("click",function(){o=e.classList.contains("dark-mode")?"light":"dark",r(o);try{const e="true"===this.getAttribute("aria-pressed");this.setAttribute("aria-pressed",(!e).toString()),this.setAttribute("title","dark"===o?"Comută la tema luminoasă":"Comută la tema întunecată")}catch(t){}});try{const t=window.matchMedia("(prefers-color-scheme: dark)");t.addEventListener("change",e=>{localStorage.getItem("theme")||r(e.matches?"dark":"light")})}catch(t){}}window.addEventListener("storage",t=>{"theme"===t.key&&("dark"===t.newValue||"light"===t.newValue)&&(r(t.newValue),t&&function(){try{t.setAttribute("aria-pressed",("dark"===t.newValue).toString())}catch(t){}}())})}(),document.querySelectorAll(".copy-btn").forEach(t=>{t.addEventListener("click",function(){const e=this.dataset.target,n=document.querySelector(e);if(n){const e=n.innerText||n.textContent;navigator.clipboard.writeText(e).then(()=>{const e=this.innerHTML;this.innerHTML='<i class="fas fa-check"></i> Copiat!',this.classList.remove("btn-outline-secondary"),this.classList.add("btn-success"),setTimeout(()=>{this.innerHTML=e,this.classList.remove("btn-success"),this.classList.add("btn-outline-secondary")},2e3)}).catch(e=>{console.error("Eroare la copierea textului: ",e),alert("Eroare la copierea textului. Este posibil ca browserul dvs. să nu suporte această funcționalitate.")})}})}),function(){if(!document.querySelector(".table"))return;const t=document.createElement("div");t.className="fab-container";const e=document.createElement("button");e.className="btn btn-secondary fab-button no-loader",e.type="button",e.title="Printează pagina (Shift+P)",e.innerHTML='<i class="fas fa-print"></i>',e.addEventListener("click",()=>window.print());const n=document.createElement("button");n.className="btn btn-secondary fab-button no-loader",n.type="button",n.title="Mergi sus (Shift+T)",n.innerHTML='<i class="fas fa-arrow-up"></i>',n.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"})),t.appendChild(e),t.appendChild(n),document.body.appendChild(t)}(),document.addEventListener("keydown",t=>{t.shiftKey&&!t.ctrlKey&&!t.altKey&&("d"===t.key.toLowerCase()?document.getElementById("darkModeToggle")&&document.getElementById("darkModeToggle").click():"p"===t.key.toLowerCase()?window.print():"t"===t.key.toLowerCase()&&window.scrollTo({top:0,behavior:"smooth"}))});function r(t){try{const e="form:"+location.pathname,n=localStorage.getItem(e);if(!n)return;const r=JSON.parse(n);Array.from(t.elements).forEach(t=>{t.name&&("checkbox"===t.type||"radio"===t.type?t.checked=!!r[t.name]:"SELECT"===t.tagName?Array.isArray(r[t.name])?Array.from(t.options).forEach(e=>e.selected=r[t.name].includes(e.value)):t.value=null!=r[t.name]?r[t.name]:t.value:t.value=null!=r[t.name]?r[t.name]:t.value)})}catch(t){}}function o(t){try{const e="form:"+location.pathname,n={};Array.from(t.elements).forEach(t=>{t.name&&("checkbox"===t.type?n[t.name]=t.checked:"radio"===t.type?t.checked&&(n[t.name]=t.value):"SELECT"===t.tagName&&t.multiple?n[t.name]=Array.from(t.selectedOptions).map(t=>t.value):n[t.name]=t.value)}),localStorage.setItem(e,JSON.stringify(n))}catch(t){}}document.querySelectorAll("form").forEach(t=>{const e=("GET"===((t.method||"GET").toUpperCase())),n=/login|logout|password/i.test(t.action||"")||t.querySelector('input[type="password"]');e&&!n&&(r(t),t.addEventListener("change",()=>o(t)),t.addEventListener("input",()=>o(t)))});function a(t){const e=t.trim();if(!e)return"text";const n=e.replace(/\s/g,"").replace(",",".");if(!isNaN(n)&&""!==n)return"number";return/^\d{1,2}[:\.\-]\d{1,2}([:\.\-]\d{2,4})?$/.test(e)||/\d{4}-\d{2}-\d{2}/.test(e)?"text-dateish":"text"}function c(t){return(t.getAttribute("data-value")||t.innerText||"").replace(/\s+/g," ").trim()}function i(t,e,n){if("number"===n)return parseFloat(t.replace(",","."))-parseFloat(e.replace(",","."));return t.localeCompare(e,void 0,{sensitivity:"base",numeric:!0})}function u(t){const e=t.querySelector("thead");if(!e)return;function n(n,r){const o=t.querySelector("tbody");if(!o)return;const a=Array.from(o.querySelectorAll("tr"));if(0===a.length)return;const u=c(a[0].children[n]||{innerText:""}),l=a(u),s=r.getAttribute("aria-sort"),d="ascending"===s?"descending":"ascending";e.querySelectorAll("th[aria-sort]").forEach(t=>t.removeAttribute("aria-sort")),r.setAttribute("aria-sort",d),a.sort((function(e,r){const o=c(e.children[n]||{innerText:""}),a=c(r.children[n]||{innerText:""}),u=i(o,a,l);return"ascending"===d?u:-u})),a.forEach(t=>o.appendChild(t))}e.querySelectorAll("th").forEach((t,e)=>{t.classList.contains("no-sort")||(t.classList.add("th-sortable"),t.tabIndex=0,t.setAttribute("role","button"),t.addEventListener("click",()=>n(e,t)),t.addEventListener("keydown",o=>{"Enter"!==o.key&&" "!==o.key||(o.preventDefault(),n(e,t))}))})}function l(){document.querySelectorAll("table.table").forEach(t=>{if(!t.closest(".table-responsive")){let e=document.createElement("div");e.className="table-responsive",t.parentNode.insertBefore(e,t),e.appendChild(t)}t.classList.add("table-sticky-header")})}function s(t){return Array.from(t.querySelectorAll("td")).filter(t=>null!==t.offsetParent&&"none"!==t.style.display).map(c).join("\t")}function d(t,e="Copiat"){let n=document.createElement("div");n.className="copy-bubble",n.innerText=e,document.body.appendChild(n);let r=t.getBoundingClientRect();n.style.left=r.left+r.width/2+window.scrollX+"px",n.style.top=r.top+window.scrollY-4+"px",setTimeout(()=>n.classList.add("show"),10),setTimeout(()=>{n.classList.remove("show"),setTimeout(()=>n.remove(),180)},1200)}let f=null;function y(){f&&(f.remove(),f=null),document.removeEventListener("mousedown",y,!0),document.removeEventListener("scroll",y,!0),document.removeEventListener("keydown",p,!0)}function p(t){"Escape"===t.key&&y()}function v(t,e){y(),f=document.createElement("div"),f.className="context-menu",f.innerHTML='<div class="item" data-act="cell">Copiază celula</div><div class="item" data-act="row">Copiază rândul</div>',document.body.appendChild(f);let n=t.clientX,r=t.clientY,o=180,a=80;n+o>window.innerWidth&&(n=window.innerWidth-o-6),r+a>window.innerHeight&&(r=window.innerHeight-a-6),f.style.left=n+"px",f.style.top=r+"px",f.querySelector("[data-act=cell]").onclick=function(){navigator.clipboard.writeText(c(e)),d(e),y()},f.querySelector("[data-act=row]").onclick=function(){navigator.clipboard.writeText(s(e.parentElement)),d(e.parentElement),y()},setTimeout(()=>{document.addEventListener("mousedown",y,!0),document.addEventListener("scroll",y,!0),document.addEventListener("keydown",p,!0)},10)}function m(t){if(t.hasAttribute("data-copy-handler"))return;t.setAttribute("data-copy-handler","1"),t.addEventListener("dblclick",function(n){navigator.clipboard.writeText(c(t)),d(t),n.preventDefault()}),t.addEventListener("contextmenu",function(n){n.preventDefault(),v(n,t)});let e=null;t.addEventListener("touchstart",function(){e&&clearTimeout(e),e=setTimeout(()=>{navigator.clipboard.writeText(c(t)),d(t)},600)},{passive:!0}),t.addEventListener("touchend",function(){e&&clearTimeout(e)}),t.addEventListener("touchcancel",function(){e&&clearTimeout(e)})}function h(){document.querySelectorAll("table.table tbody td").forEach(m)}function b(t){const e=t.querySelector("thead"),n=t.querySelector("tbody");if(!e||!n)return;const r=document.createElement("div");r.className="table-tools d-flex flex-wrap align-items-center gap-2 mb-2";const o=document.createElement("input");o.className="form-control form-control-sm table-filter-input",o.type="search",o.placeholder="Filtrează rânduri (Shift+F)",o.autocomplete="off",r.appendChild(o);const a=document.createElement("button");a.className="btn btn-outline-secondary btn-sm",a.type="button",a.title="Comută densitatea tabelului",a.innerHTML='<i class="fas fa-compress-arrows-alt"></i>',a.addEventListener("click",()=>{t.classList.toggle("table-compact")}),r.appendChild(a);const i=document.createElement("div");i.className="dropdown d-inline-block",i.innerHTML='<button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">Coloane</button><div class="dropdown-menu p-2 columns-menu" style="min-width: 220px;"></div>';const u=i.querySelector(".columns-menu");r.appendChild(i);const l=t.closest(".table-responsive");l&&l.parentElement?l.parentElement.insertBefore(r,l):t.parentElement.insertBefore(r,t);const f=Array.from(e.querySelectorAll("th")),y="columns:"+location.pathname;let p=f.map(()=>!0);try{const t=JSON.parse(localStorage.getItem(y)||"null");Array.isArray(t)&&t.length===p.length&&(p=t)}catch(t){}function v(){Array.from(t.querySelectorAll("tr")).forEach((t=>{f.forEach(((e,n)=>{const r=t.children[n];r&&(r.style.display=p[n]?"":"none")}))}))}function m(){try{localStorage.setItem(y,JSON.stringify(p))}catch(t){}}f.forEach(((t,e)=>{const n=document.createElement("label");n.className="dropdown-item d-flex align-items-center gap-2";const r=document.createElement("input");r.type="checkbox",r.className="form-check-input",r.checked=p[e],r.addEventListener("change",(()=>{p[e]=r.checked,v(),m()})),n.appendChild(r);const o=document.createElement("span");o.textContent=(t.innerText||t.textContent||`Col ${e+1}`).trim()||`Col ${e+1}`,n.appendChild(o),u.appendChild(n)})),v();o.addEventListener("input",(function(){const t=o.value.trim().toLowerCase(),e=Array.from(n.querySelectorAll("tr"));if(!t)return void e.forEach((t=>{t.style.display=""}));e.forEach((e=>{const n=(e.innerText||"").toLowerCase();e.style.display=n.includes(t)?"": "none"}))})),document.addEventListener("keydown",(t=>{t.shiftKey&&!t.ctrlKey&&!t.altKey&&"f"===t.key.toLowerCase()&&(o.focus(),t.preventDefault())}));const g=document.createElement("button");g.className="btn btn-outline-secondary btn-sm",g.type="button",g.title="Copiază tabelul vizibil",g.innerHTML='<i class="fas fa-copy"></i> Copiază tabelul',g.addEventListener("click",(()=>{let t=[],e=[];f.forEach(((n,r)=>{n.offsetParent!==null&&"none"!==n.style.display&&!/ac.tiuni/i.test(n.innerText)&&e.push((n.innerText||"").trim())})),t.push(e.join("\t")),Array.from(n.querySelectorAll("tr")).forEach((n=>{if("none"===n.style.display)return;let r=[];Array.from(n.children).forEach(((t,e)=>{t.offsetParent!==null&&"none"!==t.style.display&&r.push(c(t))})),r.length&&t.push(r.join("\t"))})),navigator.clipboard.writeText(t.join("\n")),d(g,"Tabel copiat")})),r.appendChild(g)}document.querySelectorAll("table.table").forEach((t=>{u(t),b(t)})),h();!function(){if("1"===localStorage.getItem("coach:copy"))return;const t=document.querySelector(".table");if(!t)return;let e=document.createElement("div");e.className="coachmark-copy",e.innerHTML='<span><i class="fas fa-mouse-pointer"></i> Dublu-click pentru a copia celula. Click dreapta pentru opțiuni.</span><button class="close" tabindex="0">&times;</button>';let n=t.closest(".table-responsive")?.parentElement||t.parentElement;n.insertBefore(e,t.closest(".table-responsive")||t),e.querySelector(".close").onclick=()=>{e.remove(),localStorage.setItem("coach:copy","1")}}(),function(){if("serviceWorker"in navigator)navigator.serviceWorker.register("/static/sw.js").catch(()=>{})}(),function(){const t=Array.from(document.querySelectorAll("a[href]")).filter(t=>t.href&&!t.href.startsWith("javascript:")&&!t.getAttribute("href").startsWith("#")).map(t=>({href:t.getAttribute("href"),text:(t.innerText||t.title||t.href).replace(/\s+/g," ").trim()})).filter(t=>t.text).reduce(((t,e)=>t.find(n=>n.href===e.href)?t:(t.push(e),t)),[]),e=document.createElement("div");e.className="modal",e.tabIndex=-1,e.innerHTML='<div class="modal-dialog modal-dialog-centered"><div class="modal-content command-palette"><div class="modal-header py-2"><input type="search" class="form-control form-control-lg cp-input" placeholder="Caută... (Ctrl+K)"/></div><div class="modal-body p-0"><ul class="list-group list-group-flush cp-list" style="max-height:50vh;overflow:auto"></ul></div></div></div>',document.body.appendChild(e);let n=null;try{n=new bootstrap.Modal(e,{backdrop:!0})}catch(t){}const r=e.querySelector(".cp-input"),o=e.querySelector(".cp-list");function a(e){o.innerHTML="",e.slice(0,50).forEach((t=>{const e=document.createElement("li");e.className="list-group-item list-group-item-action",e.textContent=t.text,e.addEventListener("click",(()=>{window.location.href=t.href})),o.appendChild(e)}))}function c(){a(t),n?n.show():e.style.display="block",setTimeout((()=>r.focus()),100)}function i(){n?n.hide():e.style.display="none"}r.addEventListener("input",(()=>{const e=r.value.toLowerCase().trim();if(!e)return a(t);const n=t.filter((t=>t.text.toLowerCase().includes(e)));a(n)})),r.addEventListener("keydown",(t=>{"Escape"===t.key&&i()})),document.addEventListener("keydown",(t=>{(t.ctrlKey||t.metaKey)&&"k"===t.key.toLowerCase()&&(t.preventDefault(),c())}))}()});