// Faithfully minified Genie main.js with all required features
document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("loading-overlay");function t(){e&&e.classList.add("show")}function n(){e&&e.classList.remove("show")}n(),document.querySelectorAll("a").forEach(e=>{e.addEventListener("click",function(e){if("_blank"===this.target||this.href.startsWith("javascript:")||this.classList.contains("no-loader"))return;if(this.hash&&this.pathname===window.location.pathname)return;const r=this.getAttribute("data-bs-toggle");if("dropdown"===r||"collapse"===r||"modal"===r)return;const o=(this.getAttribute("href")||"").toLowerCase();if(o.includes("export")||o.includes("download")||o.endsWith(".docx")||o.endsWith(".csv")||o.endsWith(".xlsx"))return;t(),setTimeout(n,8e3)},!1)}),document.querySelectorAll("form").forEach(e=>{e.addEventListener("submit",function(){if("_blank"===this.target||this.classList.contains("no-loader"))return;t(),setTimeout(n,8e3);})}),window.addEventListener("load",n),window.addEventListener("pageshow",function(e){e.persisted&&n()});const r=document.getElementById("darkModeToggle"),o=document.body,i=r?r.querySelector("i"):null;function a(e){"dark"===e?(o.classList.add("dark-mode"),i&&(i.classList.remove("fa-moon"),i.classList.add("fa-sun")),localStorage.setItem("theme","dark")):(o.classList.remove("dark-mode"),i&&(i.classList.remove("fa-sun"),i.classList.add("fa-moon")),localStorage.setItem("theme","light"));try{const t=document.querySelector('meta[media="(prefers-color-scheme: light)"][name="theme-color"]'),n=document.querySelector('meta[media="(prefers-color-scheme: dark)"][name="theme-color"]');t&&n&&("dark"===e?n.setAttribute("content",getComputedStyle(document.documentElement).getPropertyValue("--bg-main").trim()||"#1a1a1a"):t.setAttribute("content",getComputedStyle(document.documentElement).getPropertyValue("--bg-main").trim()||"#f8f9fa"))}catch(e){}}if(r&&i){let e=localStorage.getItem("theme");e||(e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),a(e);try{r.setAttribute("aria-pressed",("dark"===e).toString()),r.setAttribute("title","dark"===e?"Comută la tema luminoasă":"Comută la tema întunecată")}catch(e){}r.addEventListener("click",function(){e=o.classList.contains("dark-mode")?"light":"dark",a(e);try{const t="true"===this.getAttribute("aria-pressed");this.setAttribute("aria-pressed",(!t).toString()),this.setAttribute("title","dark"===e?"Comută la tema luminoasă":"Comută la tema întunecată")}catch(e){}});try{const e=window.matchMedia("(prefers-color-scheme: dark)");e.addEventListener("change",e=>{localStorage.getItem("theme")||a(e.matches?"dark":"light")})}catch(e){}}window.addEventListener("storage",e=>{"theme"===e.key&&("dark"===e.newValue||"light"===e.newValue)&&(a(e.newValue),r&&function(){try{r.setAttribute("aria-pressed",("dark"===e.newValue).toString())}catch(e){}}())});document.querySelectorAll(".copy-btn").forEach(function(e){e.addEventListener("click",function(){const t=this.dataset.target,n=document.querySelector(t);if(n){const t=n.innerText||n.textContent;navigator.clipboard.writeText(t).then(()=>{const t=this.innerHTML;this.innerHTML='<i class="fas fa-check"></i> Copiat!',this.classList.remove("btn-outline-secondary"),this.classList.add("btn-success"),setTimeout(()=>{this.innerHTML=t,this.classList.remove("btn-success"),this.classList.add("btn-outline-secondary")},2e3)}).catch(e=>{console.error("Eroare la copierea textului: ",e),alert("Eroare la copierea textului. Este posibil ca browserul dvs. să nu suporte această funcționalitate.")})}})});(function(){if(!document.querySelector(".table"))return;const e=document.createElement("div");e.className="fab-container";const t=document.createElement("button");t.className="btn btn-secondary fab-button no-loader",t.type="button",t.title="Printează pagina (Shift+P)",t.innerHTML='<i class="fas fa-print"></i>',t.addEventListener("click",()=>window.print());const n=document.createElement("button");n.className="btn btn-secondary fab-button no-loader",n.type="button",n.title="Mergi sus (Shift+T)",n.innerHTML='<i class="fas fa-arrow-up"></i>',n.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"})),e.appendChild(t),e.appendChild(n),document.body.appendChild(e)})();document.addEventListener("keydown",function(e){e.shiftKey&&!e.ctrlKey&&!e.altKey&&("d"===e.key.toLowerCase()?r&&r.click():"p"===e.key.toLowerCase()?window.print():"t"===e.key.toLowerCase()&&window.scrollTo({top:0,behavior:"smooth"}))});function c(e){try{const t="form:"+location.pathname,n=localStorage.getItem(t);if(!n)return;const r=JSON.parse(n);Array.from(e.elements).forEach(e=>{e.name&&("checkbox"===e.type||"radio"===e.type?e.checked=!!r[e.name]:"SELECT"===e.tagName?Array.isArray(r[e.name])?Array.from(e.options).forEach(t=>t.selected=r[e.name].includes(t.value)):e.value=null!=r[e.name]?r[e.name]:e.value:e.value=null!=r[e.name]?r[e.name]:e.value)})}catch(e){}}function l(e){try{const t="form:"+location.pathname,n={};Array.from(e.elements).forEach(e=>{e.name&&("checkbox"===e.type?n[e.name]=e.checked:"radio"===e.type?e.checked&&(n[e.name]=e.value):"SELECT"===e.tagName&&e.multiple?n[e.name]=Array.from(e.selectedOptions).map(e=>e.value):n[e.name]=e.value)}),localStorage.setItem(t,JSON.stringify(n))}catch(e){}}document.querySelectorAll("form").forEach(function(e){const t=("GET"===((e.method||"GET").toUpperCase())),n=/login|logout|password/i.test(e.action||"")||e.querySelector('input[type="password"]');t&&!n&&(c(e),e.addEventListener("change",()=>l(e)),e.addEventListener("input",()=>l(e)))});function s(e){const t=e.trim();if(!t)return"text";const n=t.replace(/\s/g,"").replace(",",".");if(!isNaN(n)&&n!=="")return"number";if(/^\d{1,2}[:\.\-]\d{1,2}([:\.\-]\d{2,4})?$/.test(t)||/\d{4}-\d{2}-\d{2}/.test(t))return"text-dateish";return"text"}function d(e){return(e.getAttribute("data-value")||e.innerText||"").replace(/\s+/g," ").trim()}function u(e,t,n){if("number"===n)return parseFloat(e.replace(",","."))-parseFloat(t.replace(",","."));return e.localeCompare(t,void 0,{sensitivity:"base",numeric:!0})}function f(e){const t=e.querySelector("thead");if(!t)return;t.querySelectorAll("th").forEach(function(n,r){t.classList.contains("no-sort")||(n.classList.add("th-sortable"),n.tabIndex=0,n.setAttribute("role","button"),n.addEventListener("click",function(){m(r,n)}),n.addEventListener("keydown",function(e){("Enter"===e.key||" "===e.key)&&(e.preventDefault(),m(r,n))}));function m(r,n){const o=e.querySelector("tbody");if(!o)return;const i=Array.from(o.querySelectorAll("tr"));if(0===i.length)return;const a=d(i[0].children[r]||{innerText:""}),c=s(a),l=n.getAttribute("aria-sort"),f="ascending"===l?"descending":"ascending";t.querySelectorAll("th[aria-sort]").forEach(e=>e.removeAttribute("aria-sort")),n.setAttribute("aria-sort",f),i.sort(function(e,n){const o=d(e.children[r]||{innerText:""}),i=d(n.children[r]||{innerText:""}),a=u(o,i,c);return"ascending"===f?a:-a}),i.forEach(e=>o.appendChild(e))}})}function p(){document.querySelectorAll("table.table").forEach(function(e){if(!e.closest(".table-responsive")){let t=document.createElement("div");t.className="table-responsive",e.parentNode.insertBefore(t,e),t.appendChild(e)}e.classList.add("table-sticky-header")})}p();function h(e){return Array.from(e.querySelectorAll("td")).filter(e=>null!==e.offsetParent&&"none"!==e.style.display).map(d).join("\t")}function y(e,t="Copiat"){let n=document.createElement("div");n.className="copy-bubble",n.innerText=t,document.body.appendChild(n);const r=e.getBoundingClientRect();n.style.left=r.left+r.width/2+window.scrollX+"px",n.style.top=r.top+window.scrollY-4+"px",setTimeout(()=>n.classList.add("show"),10),setTimeout(()=>{n.classList.remove("show"),setTimeout(()=>n.remove(),180)},1200)}let m=null;function v(){m&&(m.remove(),m=null),document.removeEventListener("mousedown",v,!0),document.removeEventListener("scroll",v,!0),document.removeEventListener("keydown",b,!0)}function b(e){"Escape"===e.key&&v()}function g(e,t){v(),m=document.createElement("div"),m.className="context-menu",m.innerHTML='<div class="item" data-act="cell">Copiază celula</div><div class="item" data-act="row">Copiază rândul</div>',document.body.appendChild(m);let n=e.clientX,r=e.clientY,o=180,i=80;n+o>window.innerWidth&&(n=window.innerWidth-o-6),r+i>window.innerHeight&&(r=window.innerHeight-i-6),m.style.left=n+"px",m.style.top=r+"px",m.querySelector('[data-act=cell]').onclick=function(){navigator.clipboard.writeText(d(t)),y(t),v()},m.querySelector('[data-act=row]').onclick=function(){navigator.clipboard.writeText(h(t.parentElement)),y(t.parentElement),v()},setTimeout(()=>{document.addEventListener("mousedown",v,!0),document.addEventListener("scroll",v,!0),document.addEventListener("keydown",b,!0)},10)}function w(e){if(e.hasAttribute("data-copy-handler"))return;e.setAttribute("data-copy-handler","1"),e.addEventListener("dblclick",function(t){navigator.clipboard.writeText(d(e)),y(e),t.preventDefault()}),e.addEventListener("contextmenu",function(t){t.preventDefault(),g(t,e)});let n=null;e.addEventListener("touchstart",function(){n&&clearTimeout(n),n=setTimeout(()=>{navigator.clipboard.writeText(d(e)),y(e)},600)},{passive:!0}),e.addEventListener("touchend",function(){n&&clearTimeout(n)}),e.addEventListener("touchcancel",function(){n&&clearTimeout(n)})}function k(){document.querySelectorAll("table.table tbody td").forEach(w)}function T(e){const t=e.querySelector("thead"),n=e.querySelector("tbody");if(!t||!n)return;const r=document.createElement("div");r.className="table-tools d-flex flex-wrap align-items-center gap-2 mb-2";const o=document.createElement("input");o.className="form-control form-control-sm table-filter-input",o.type="search",o.placeholder="Filtrează rânduri (Shift+F)",o.autocomplete="off",r.appendChild(o);const i=document.createElement("button");i.className="btn btn-outline-secondary btn-sm",i.type="button",i.title="Comută densitatea tabelului",i.innerHTML='<i class="fas fa-compress-arrows-alt"></i>',i.addEventListener("click",()=>{e.classList.toggle("table-compact")}),r.appendChild(i);const a=document.createElement("div");a.className="dropdown d-inline-block",a.innerHTML='<button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">Coloane</button><div class="dropdown-menu p-2 columns-menu" style="min-width: 220px;"></div>';const c=a.querySelector(".columns-menu");r.appendChild(a);const l=e.closest(".table-responsive");l&&l.parentElement?l.parentElement.insertBefore(r,l):e.parentElement.insertBefore(r,e);const s=Array.from(t.querySelectorAll("th")),f="columns:"+location.pathname;let p=s.map(()=>!0);try{const e=JSON.parse(localStorage.getItem(f)||"null");Array.isArray(e)&&e.length===p.length&&(p=e)}catch(e){}function v(){Array.from(e.querySelectorAll("tr")).forEach(e=>{s.forEach((t,n)=>{const r=e.children[n];r&&(r.style.display=p[n]?"":"none")})})}function m(){try{localStorage.setItem(f,JSON.stringify(p))}catch(e){}}s.forEach((t,e)=>{const n=document.createElement("label");n.className="dropdown-item d-flex align-items-center gap-2";const r=document.createElement("input");r.type="checkbox",r.className="form-check-input",r.checked=p[e],r.addEventListener("change",()=>{p[e]=r.checked,v(),m()}),n.appendChild(r);const o=document.createElement("span");o.textContent=(t.innerText||t.textContent||`Col ${e+1}`).trim()||`Col ${e+1}`,n.appendChild(o),c.appendChild(n)}),v();o.addEventListener("input",function(){const t=o.value.trim().toLowerCase(),n=Array.from(n.querySelectorAll("tr"));if(!t)return void n.forEach(e=>{e.style.display=""});n.forEach(e=>{const r=(e.innerText||"").toLowerCase();e.style.display=r.includes(t)?"":"none"})}),document.addEventListener("keydown",function(e){e.shiftKey&&!e.ctrlKey&&!e.altKey&&"f"===e.key.toLowerCase()&&(o.focus(),e.preventDefault())});const u=document.createElement("button");u.className="btn btn-outline-secondary btn-sm",u.type="button",u.title="Copiază tabelul vizibil",u.innerHTML='<i class="fas fa-copy"></i> Copiază tabelul',u.addEventListener("click",()=>{let t=[],n=[];s.forEach((e,r)=>{e.offsetParent!==null&&"none"!==e.style.display&&!/ac.tiuni/i.test(e.innerText)&&n.push((e.innerText||"").trim())}),t.push(n.join("\t")),Array.from(n.querySelectorAll("tr")).forEach(n=>{if("none"===n.style.display)return;let r=[];Array.from(n.children).forEach((e,o)=>{e.offsetParent!==null&&"none"!==e.style.display&&r.push(d(e))}),r.length&&t.push(r.join("\t"))}),navigator.clipboard.writeText(t.join("\n")),y(u,"Tabel copiat")}),r.appendChild(u)}document.querySelectorAll("table.table").forEach(e=>{f(e),T(e)}),k();!function(){if("1"===localStorage.getItem("coach:copy"))return;const e=document.querySelector(".table");if(!e)return;let t=document.createElement("div");t.className="coachmark-copy",t.innerHTML='<span><i class="fas fa-mouse-pointer"></i> Dublu-click pentru a copia celula. Click dreapta pentru opțiuni.</span><button class="close" tabindex="0">&times;</button>';let n=e.closest(".table-responsive")?.parentElement||e.parentElement;n.insertBefore(t,e.closest(".table-responsive")||e),t.querySelector(".close").onclick=()=>{t.remove(),localStorage.setItem("coach:copy","1")}}(),function(){if("serviceWorker"in navigator)navigator.serviceWorker.register("/static/sw.js").catch(()=>{})}(),function(){const e=Array.from(document.querySelectorAll("a[href]")).filter(e=>e.href&&!e.href.startsWith("javascript:")&&!e.getAttribute("href").startsWith("#")).map(e=>({href:e.getAttribute("href"),text:(e.innerText||e.title||e.href).replace(/\s+/g," ").trim()})).filter(e=>e.text).reduce((e,t)=>e.find(n=>n.href===t.href)?e:(e.push(t),e),[]),t=document.createElement("div");t.className="modal",t.tabIndex=-1,t.innerHTML='<div class="modal-dialog modal-dialog-centered"><div class="modal-content command-palette"><div class="modal-header py-2"><input type="search" class="form-control form-control-lg cp-input" placeholder="Caută... (Ctrl+K)"/></div><div class="modal-body p-0"><ul class="list-group list-group-flush cp-list" style="max-height:50vh;overflow:auto"></ul></div></div></div>',document.body.appendChild(t);let n=null;try{n=new bootstrap.Modal(t,{backdrop:!0})}catch(e){}const r=t.querySelector(".cp-input"),o=t.querySelector(".cp-list");function i(t){o.innerHTML="",t.slice(0,50).forEach(e=>{const t=document.createElement("li");t.className="list-group-item list-group-item-action",t.textContent=e.text,t.addEventListener("click",()=>{window.location.href=e.href}),o.appendChild(t)})}function a(){i(e),n?n.show():t.style.display="block",setTimeout(()=>r.focus(),100)}function c(){n?n.hide():t.style.display="none"}r.addEventListener("input",()=>{const t=r.value.toLowerCase().trim();if(!t)return i(e);const n=e.filter(e=>e.text.toLowerCase().includes(t));i(n)}),r.addEventListener("keydown",e=>{"Escape"===e.key&&c()}),document.addEventListener("keydown",e=>(e.ctrlKey||e.metaKey)&&"k"===e.key.toLowerCase()&&(e.preventDefault(),a()))}()});